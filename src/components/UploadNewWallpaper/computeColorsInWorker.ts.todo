import { hydrateColorStats } from '../../utils/image/utils/hydrateColorStats';
import { IImageColorStats } from '../../utils/image/utils/IImageColorStats';
import { Json } from '../../utils/supabase/types';

export function computeColorsInWorker(computeName: string): Promise<IImageColorStats<string>> {
    return new Promise((resolve, reject) => {
        const worker = new Worker(new URL('../worker.ts', import.meta.url));

        worker.postMessage(computeName);
        worker.onmessage = (event: MessageEvent<Json>) => {
            console.log(event);
            const colorStats = hydrateColorStats(event.data);
            resolve(colorStats);
        };
    });
}

/**
 * TODO: !!!! Use or remove
 * TODO: Messages to show loading
 * TODO: Use in UploadNewWallpaper
 * TODO: Use in colors modal
 */
